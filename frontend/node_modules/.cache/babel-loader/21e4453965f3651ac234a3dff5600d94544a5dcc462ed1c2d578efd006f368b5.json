{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{Camera,CameraOff,Mic,MicOff}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CameraView=_ref=>{let{onPermissionGranted,onPermissionDenied}=_ref;const videoRef=useRef(null);const[stream,setStream]=useState(null);const[isAudioEnabled,setIsAudioEnabled]=useState(true);const[isVideoEnabled,setIsVideoEnabled]=useState(true);const[error,setError]=useState(null);useEffect(()=>{requestMediaPermissions();return()=>{// Cleanup: stop all tracks when component unmounts\nif(stream){stream.getTracks().forEach(track=>track.stop());}};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);const requestMediaPermissions=async()=>{try{const mediaStream=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:'user'},audio:true});setStream(mediaStream);if(videoRef.current){videoRef.current.srcObject=mediaStream;}if(onPermissionGranted){onPermissionGranted(mediaStream);}}catch(err){console.error('Error accessing media devices:',err);setError(err.message);if(onPermissionDenied){onPermissionDenied(err);}}};const toggleAudio=()=>{if(stream){const audioTrack=stream.getAudioTracks()[0];if(audioTrack){audioTrack.enabled=!audioTrack.enabled;setIsAudioEnabled(audioTrack.enabled);}}};const toggleVideo=()=>{if(stream){const videoTrack=stream.getVideoTracks()[0];if(videoTrack){videoTrack.enabled=!videoTrack.enabled;setIsVideoEnabled(videoTrack.enabled);}}};if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"relative w-full h-full bg-slate-800 rounded-lg overflow-hidden flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-slate-300 p-4\",children:[/*#__PURE__*/_jsx(CameraOff,{className:\"w-12 h-12 mx-auto mb-2 opacity-50\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Camera access denied\"}),/*#__PURE__*/_jsx(\"button\",{onClick:requestMediaPermissions,className:\"mt-2 text-xs text-amber-600 hover:text-amber-700 underline\",children:\"Retry\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full h-full bg-slate-900 rounded-lg overflow-hidden shadow-lg border border-slate-700\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true,playsInline:true,muted:true,className:\"w-full h-full object-cover\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-3 left-3 px-3 py-1 bg-emerald-600 text-white text-xs font-medium rounded-full flex items-center gap-1.5\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"w-2 h-2 bg-white rounded-full animate-pulse\"}),\"Interview in progress\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-3 right-3 flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:toggleAudio,className:\"p-2 rounded-full transition-colors \".concat(isAudioEnabled?'bg-slate-700/80 hover:bg-slate-600 text-white':'bg-red-600 hover:bg-red-700 text-white'),title:isAudioEnabled?'Mute':'Unmute',children:isAudioEnabled?/*#__PURE__*/_jsx(Mic,{className:\"w-4 h-4\"}):/*#__PURE__*/_jsx(MicOff,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleVideo,className:\"p-2 rounded-full transition-colors \".concat(isVideoEnabled?'bg-slate-700/80 hover:bg-slate-600 text-white':'bg-red-600 hover:bg-red-700 text-white'),title:isVideoEnabled?'Turn off camera':'Turn on camera',children:isVideoEnabled?/*#__PURE__*/_jsx(Camera,{className:\"w-4 h-4\"}):/*#__PURE__*/_jsx(CameraOff,{className:\"w-4 h-4\"})})]})]});};export default CameraView;","map":{"version":3,"names":["React","useEffect","useRef","useState","Camera","CameraOff","Mic","MicOff","jsx","_jsx","jsxs","_jsxs","CameraView","_ref","onPermissionGranted","onPermissionDenied","videoRef","stream","setStream","isAudioEnabled","setIsAudioEnabled","isVideoEnabled","setIsVideoEnabled","error","setError","requestMediaPermissions","getTracks","forEach","track","stop","mediaStream","navigator","mediaDevices","getUserMedia","video","width","ideal","height","facingMode","audio","current","srcObject","err","console","message","toggleAudio","audioTrack","getAudioTracks","enabled","toggleVideo","videoTrack","getVideoTracks","className","children","onClick","ref","autoPlay","playsInline","muted","concat","title"],"sources":["/Users/pruthanj/d/frontend/src/components/CameraView.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { Camera, CameraOff, Mic, MicOff } from 'lucide-react';\n\nconst CameraView = ({ onPermissionGranted, onPermissionDenied }) => {\n  const videoRef = useRef(null);\n  const [stream, setStream] = useState(null);\n  const [isAudioEnabled, setIsAudioEnabled] = useState(true);\n  const [isVideoEnabled, setIsVideoEnabled] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    requestMediaPermissions();\n    \n    return () => {\n      // Cleanup: stop all tracks when component unmounts\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const requestMediaPermissions = async () => {\n    try {\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: { ideal: 1280 },\n          height: { ideal: 720 },\n          facingMode: 'user'\n        },\n        audio: true\n      });\n      \n      setStream(mediaStream);\n      \n      if (videoRef.current) {\n        videoRef.current.srcObject = mediaStream;\n      }\n      \n      if (onPermissionGranted) {\n        onPermissionGranted(mediaStream);\n      }\n    } catch (err) {\n      console.error('Error accessing media devices:', err);\n      setError(err.message);\n      \n      if (onPermissionDenied) {\n        onPermissionDenied(err);\n      }\n    }\n  };\n\n  const toggleAudio = () => {\n    if (stream) {\n      const audioTrack = stream.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        setIsAudioEnabled(audioTrack.enabled);\n      }\n    }\n  };\n\n  const toggleVideo = () => {\n    if (stream) {\n      const videoTrack = stream.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !videoTrack.enabled;\n        setIsVideoEnabled(videoTrack.enabled);\n      }\n    }\n  };\n\n  if (error) {\n    return (\n      <div className=\"relative w-full h-full bg-slate-800 rounded-lg overflow-hidden flex items-center justify-center\">\n        <div className=\"text-center text-slate-300 p-4\">\n          <CameraOff className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\n          <p className=\"text-sm\">Camera access denied</p>\n          <button \n            onClick={requestMediaPermissions}\n            className=\"mt-2 text-xs text-amber-600 hover:text-amber-700 underline\"\n          >\n            Retry\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative w-full h-full bg-slate-900 rounded-lg overflow-hidden shadow-lg border border-slate-700\">\n      <video\n        ref={videoRef}\n        autoPlay\n        playsInline\n        muted\n        className=\"w-full h-full object-cover\"\n      />\n      \n      {/* Status badge */}\n      <div className=\"absolute top-3 left-3 px-3 py-1 bg-emerald-600 text-white text-xs font-medium rounded-full flex items-center gap-1.5\">\n        <span className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></span>\n        Interview in progress\n      </div>\n      \n      {/* Controls */}\n      <div className=\"absolute bottom-3 right-3 flex gap-2\">\n        <button\n          onClick={toggleAudio}\n          className={`p-2 rounded-full transition-colors ${\n            isAudioEnabled \n              ? 'bg-slate-700/80 hover:bg-slate-600 text-white' \n              : 'bg-red-600 hover:bg-red-700 text-white'\n          }`}\n          title={isAudioEnabled ? 'Mute' : 'Unmute'}\n        >\n          {isAudioEnabled ? <Mic className=\"w-4 h-4\" /> : <MicOff className=\"w-4 h-4\" />}\n        </button>\n        \n        <button\n          onClick={toggleVideo}\n          className={`p-2 rounded-full transition-colors ${\n            isVideoEnabled \n              ? 'bg-slate-700/80 hover:bg-slate-600 text-white' \n              : 'bg-red-600 hover:bg-red-700 text-white'\n          }`}\n          title={isVideoEnabled ? 'Turn off camera' : 'Turn on camera'}\n        >\n          {isVideoEnabled ? <Camera className=\"w-4 h-4\" /> : <CameraOff className=\"w-4 h-4\" />}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default CameraView;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}